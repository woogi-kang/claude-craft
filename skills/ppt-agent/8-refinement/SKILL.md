---
name: ppt-refinement
description: |
  피드백을 분석하고 PPT를 반복적으로 개선하는 Skill.
  피드백 파싱, 버전 관리, A/B 대안 제시 시 활성화.
  "피드백 반영해줘", "수정해줘", "대안 보여줘" 등의 요청에 반응.
---

# PPT Refinement Skill

피드백을 분석하고 PPT를 반복적으로 개선하는 Skill입니다.

## 피드백 처리 워크플로우

```
피드백 수신
    │
    ▼
피드백 분류
├── Critical (즉시 수정)
│   └─ 데이터 오류, 심각한 맞춤법, 핵심 메시지 문제
├── Major (권장 수정)
│   └─ 구조 개선, 디자인 일관성, 흐름 문제
└── Minor (선택적 수정)
    └─ 스타일 제안, 미세 조정, 개인 선호
    │
    ▼
액션 아이템 추출
    │
    ▼
변경 사항 적용
    │
    ▼
버전 기록
    │
    ▼
검토 요청 (Review Skill)
```

## 피드백 분류 기준

### 우선순위 매트릭스

| 우선순위 | 유형 | 설명 | 대응 시간 |
|---------|------|------|----------|
| **P0 - Critical** | 데이터 오류, 팩트 오류 | 발표 불가 수준 | 즉시 |
| **P1 - High** | 구조 변경, 핵심 메시지 수정 | 발표 품질에 영향 | 당일 |
| **P2 - Medium** | 디자인 개선, 표현 수정 | 품질 향상 | 일정 내 |
| **P3 - Low** | 미세 조정, 스타일 선호 | Nice to have | 시간 허용 시 |

### 피드백 파싱 구조

```json
{
  "feedback_item": {
    "id": "FB001",
    "source": "팀장",
    "timestamp": "2025-01-04T10:30:00Z",
    "type": "content|structure|design|data",
    "priority": "critical|major|minor",
    "target": {
      "slide": 5,
      "element": "headline"
    },
    "original": "기존 내용",
    "feedback": "피드백 내용",
    "suggested_action": "권장 조치",
    "status": "pending|in_progress|resolved|rejected"
  }
}
```

## A/B 대안 제시

피드백에 대해 여러 대안을 제시하여 선택을 돕습니다.

### 대안 제시 구조

```yaml
alternatives:
  slide_5:
    context: "헤드라인 개선 요청"
    feedback: "더 임팩트 있는 표현 필요"

    version_a:
      headline: "매출 40% 성장 달성"
      style: "숫자 강조"
      pros: ["구체적", "신뢰감"]
      cons: ["다소 평범"]

    version_b:
      headline: "역대 최고 분기 실적 기록"
      style: "성과 강조"
      pros: ["감정적 임팩트", "기억에 남음"]
      cons: ["구체성 부족"]

    version_c:
      headline: "3가지 전략이 만든 40% 성장 기적"
      style: "스토리 + 숫자"
      pros: ["호기심 유발", "구체적"]
      cons: ["다소 길음"]

    recommendation: "version_c"
    reason: "스토리와 수치를 모두 포함하여 가장 효과적"
```

## 핵심 기능

### 1. feedback_parse (피드백 파싱)
다양한 형식의 피드백을 구조화합니다.

**지원 형식:**
- 자연어 피드백
- 슬라이드 주석
- 이메일/메시지
- 회의록

**파싱 예시:**
```
입력: "슬라이드 3 차트가 잘 안 보여요. 색상 대비를 높여주세요."

출력:
{
  "type": "design",
  "priority": "major",
  "target": {"slide": 3, "element": "chart"},
  "issue": "가시성 부족",
  "action": "색상 대비 증가"
}
```

### 2. change_apply (변경 적용)
파싱된 피드백을 기반으로 변경을 적용합니다.

**변경 유형:**
| 유형 | 범위 | 영향도 |
|-----|------|-------|
| **Text Edit** | 단일 요소 | 낮음 |
| **Layout Adjust** | 단일 슬라이드 | 중간 |
| **Style Change** | 전체 PPT | 높음 |
| **Structure Modify** | 슬라이드 순서/추가/삭제 | 높음 |

**변경 기록:**
```json
{
  "change_log": {
    "id": "CHG001",
    "feedback_id": "FB001",
    "type": "text_edit",
    "before": "매출 증가",
    "after": "매출 40% 증가",
    "applied_at": "2025-01-04T11:00:00Z",
    "applied_by": "system",
    "status": "applied"
  }
}
```

### 3. version_manage (버전 관리)
PPT의 버전을 체계적으로 관리합니다.

**버전 명명 규칙:**
```
[프로젝트]_v[메이저].[마이너]_[날짜]_[상태]

예시:
- InvestorPitch_v1.0_20250104_draft
- InvestorPitch_v1.1_20250104_review
- InvestorPitch_v2.0_20250105_final
```

**버전 히스토리:**
```json
{
  "version_history": [
    {
      "version": "1.0",
      "date": "2025-01-04",
      "status": "draft",
      "changes": "초안 작성",
      "author": "system"
    },
    {
      "version": "1.1",
      "date": "2025-01-04",
      "status": "review",
      "changes": "팀장 피드백 반영 (5건)",
      "author": "system"
    }
  ]
}
```

### 4. alternative_generate (대안 생성)
피드백 항목에 대해 여러 대안을 생성합니다.

**대안 생성 기준:**
```
대안 생성 가이드:
├── 최소 2개, 최대 4개 대안 제시
├── 각 대안은 명확히 구분되는 접근법
├── 장단점 명시
├── 추천안 및 이유 제공
└── 청중/목적에 따른 적합성 평가
```

### 5. batch_apply (일괄 적용)
여러 피드백을 한 번에 처리합니다.

**일괄 처리 워크플로우:**
```
피드백 목록 수신
    │
    ▼
우선순위별 정렬
    │
    ▼
충돌 감지 (같은 요소에 대한 다른 피드백)
    │
    ├─ 충돌 발견 → 사용자 결정 요청
    │
    ▼
순차 적용
    │
    ▼
적용 결과 리포트
```

## 피드백 충돌 해결

### 충돌 유형

| 충돌 유형 | 설명 | 해결 방법 |
|----------|------|----------|
| **동일 요소** | 같은 헤드라인에 대한 다른 제안 | 우선순위/최신 기준 |
| **상반된 방향** | "더 간결하게" vs "더 상세하게" | 사용자 결정 |
| **리소스 제약** | 시간 내 모든 변경 불가 | 우선순위 기반 선별 |

### 충돌 해결 프로세스

```
충돌 감지
    │
    ▼
충돌 유형 분류
    │
    ├─ 자동 해결 가능
    │   └─ 우선순위/최신 기준 적용
    │
    └─ 사용자 결정 필요
        └─ 옵션 제시 후 선택 요청
```

## 반복 개선 사이클

```
┌─────────────────────────────────────────────────────┐
│                                                     │
│   ┌─────────┐   ┌─────────┐   ┌─────────┐          │
│   │ Review  │ → │Feedback │ → │ Refine  │          │
│   │  Skill  │   │ 수집     │   │  Skill  │          │
│   └─────────┘   └─────────┘   └─────────┘          │
│        ↑                            │              │
│        │                            │              │
│        └────────────────────────────┘              │
│              반복 (품질 목표 달성까지)               │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 피드백 트래킹 대시보드

```
┌─────────────────────────────────────────────────────┐
│  피드백 현황 Dashboard                               │
├─────────────────────────────────────────────────────┤
│                                                     │
│  총 피드백: 15건                                     │
│  ├── Resolved: 10건 ████████░░ 67%                 │
│  ├── In Progress: 3건 ██░░░░░░░░ 20%               │
│  └── Pending: 2건 █░░░░░░░░░ 13%                   │
│                                                     │
│  우선순위별:                                         │
│  ├── Critical: 0/2 → 2/2 ✓                         │
│  ├── Major: 5/8 → 8/8 ✓                            │
│  └── Minor: 3/5 → 진행중                            │
│                                                     │
│  피드백 출처:                                        │
│  ├── 팀장: 8건                                      │
│  ├── 디자이너: 4건                                  │
│  └── 외부 리뷰어: 3건                               │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 사용 예시

### 예시 1: 피드백 반영 요청
```
사용자: "팀장님 피드백 반영해줘: 슬라이드 5 헤드라인이 약함"

수행:
1. feedback_parse: 피드백 구조화
2. alternative_generate: 3가지 헤드라인 대안 생성
3. 사용자 선택 또는 추천안 적용
4. change_apply: 변경 적용
5. version_manage: 버전 기록
```

### 예시 2: 일괄 피드백 처리
```
사용자: "회의에서 받은 피드백 10개 한꺼번에 처리해줘"

수행:
1. feedback_parse: 10개 피드백 파싱
2. 우선순위 정렬 및 충돌 검사
3. 충돌 항목 사용자 결정 요청
4. batch_apply: 순차 적용
5. 적용 결과 리포트 생성
6. Review Skill로 재검토 요청
```

### 예시 3: 대안 비교 요청
```
사용자: "이 차트 레이아웃 다른 옵션 보여줘"

수행:
1. 현재 레이아웃 분석
2. alternative_generate: 3가지 레이아웃 대안
3. 각 대안의 장단점 설명
4. 시각적 미리보기 제공
5. 사용자 선택 대기
```

## 변경 이력 리포트

```markdown
# 변경 이력 리포트

## 버전 정보
- **현재 버전:** v1.2
- **이전 버전:** v1.1
- **변경일:** 2025-01-04

## 변경 요약
- 총 피드백: 8건
- 적용 완료: 7건
- 보류: 1건 (추가 논의 필요)

## 상세 변경 내역

| # | 슬라이드 | 요소 | 변경 전 | 변경 후 | 출처 |
|---|---------|------|--------|--------|------|
| 1 | 5 | 헤드라인 | 매출 증가 | 매출 40% 증가 | 팀장 |
| 2 | 8 | 차트 색상 | #ff0000 | #667eea | 디자이너 |
| ... | ... | ... | ... | ... | ... |

## 보류 항목
| # | 슬라이드 | 피드백 | 보류 사유 |
|---|---------|--------|----------|
| 1 | 12 | 슬라이드 삭제 제안 | 추가 논의 필요 |

## 다음 단계
- [ ] 보류 항목 논의 후 결정
- [ ] v1.3 최종 검토
```

## 다음 단계 연결

개선 완료 후:
1. 변경된 PPT를 **Review Skill**에서 재검토
2. 검토 통과 시 **Export Skill**에서 최종 출력
3. 추가 피드백 시 Refinement 사이클 반복

## 주의사항

- 모든 변경은 버전 관리하여 롤백 가능하게 유지
- Critical 피드백은 즉시 처리, 다른 작업보다 우선
- 피드백 출처 및 의도 명확히 이해 후 적용
- 상충되는 피드백은 사용자 결정 요청
- 대규모 구조 변경은 영향 범위 사전 안내
- 피드백 반영 후 반드시 재검토 수행
